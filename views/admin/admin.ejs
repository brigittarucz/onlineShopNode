<%- include('../includes/head.ejs') %>
    
    <!-- TODO: get, update and delete in admin panel -->
    <!-- TODO: make it a transaction -->
    <!-- TODO: make the long function an API and divide the functionality -->
    <!-- TODO: recommendation system through a few queries -->
    <!-- TODO: add product to basket -->
    <!-- TODO: filter edges by from_ to be the ones contained in products, remove all the others, download csv. products and edges and replace them -->
    <!-- TODO: when filtering the recommendation still check if product from edge exists nevertheless -->
    <!-- TODO: make payment -->

    <h3>Create product</h3>
    <form id="create-product" method="POST" action="admin/create">
        <input type="text" name="brand" placeholder="Type brand" value="estÃ©e lauder">
        <input type="text" name="name" placeholder="Type name" value="Revitalizing Supreme + Global Anti-Aging Cell Power Creme">
        <input type="text" name="image" placeholder="Insert image link" value="https://s1.thcdn.com/productimg/1600/1600/11515578-9584549114350732.jpg">
        <select id="select-category" name="category" placeholder="">
            <option value="">Category</option>
            <option value="skin-care">Skin Care</option>
            <option value="makeup">Makeup</option>
            <option value="hair">Hair</option>
        </select>
        <select id="select-subcategory" name="subcategory">
        </select>
        <input type="number" name="price" step=".01" placeholder="0.00">
        <input type="number" name="quantity" placeholder="Quantity">
        <select id="select-form" name="form">
            <option value="">Form</option>
            <option value="mask">Mask</option>
            <option value="gel">Gel</option>
            <option value="cream">Cream</option>
            <option value="scrub">Scrub</option>
            <option value="serum">Serum</option>
        </select>
        <select id="select-measurement" name="measurement_unit">
            <option value="ml">ml</option>
            <option value="g">g</option>
        </select>
        <input type="number" name="discount" placeholder="Discount percentage">
        <div class="ingredients__container">
            <% ingredients.forEach(ingredient => { %>   
                <input type="checkbox" name="ingredient" value="<%= ingredient._key %>">
                <label for="ingredient"><span class="ingredient-name"><%= ingredient.ingredient_name %></span></label> <br>
            <% }) %>
        </div>
        <br>
        <p style="display: inline">Ingredient not here? Create it! 3 new ingredients are allowed. </p>
        <button id="create-ingredient" style="display: inline">Create</button> <br><br>
        <div class="ingredients__container-new">
            
        </div>
        <button type="submit">Submit</button>
    </form>

    <!-- TODO: read/update/delete with modals -->
    <h3>Manipulate product</h3>
    <div class="products__container">

        <% products.forEach(oProduct => { %>

            <div>
                <%- include('../includes/product.ejs', {oProduct: oProduct}) %>
                <form class="remove-product" method="POST" action="admin/remove" data-formProductId="<%= oProduct._id %>">
                    <input name="idProduct" type="hidden" value="<%= oProduct._id %>">
                    <button type="submit">Remove Product</button>
                </form>
            </div>

        <% }) %>

    </div>

    <template id="template-ingredient">
        <div class="new-ingredient">
            <input type="text" id="ingredient_name-input" name="ingredient_name" placeholder="Ingredient Name">
            <select id="ingredient_effect-select_a" name="ingredient_effect" required> 
                <option value="">Effect required</option>
                <% effects.forEach(effect => { %>
                    <option value="<%= effect._key %>"><%= effect.effect %></option>
                <% }) %>
            </select>
            <select id="ingredient_effect-select_b" name="ingredient_effect"> 
                <option value="">Effect optional</option>
                <% effects.forEach(effect => { %>
                    <option value="<%= effect._key %>"><%= effect.effect %></option>
                <% }) %>
            </select>
            <select id="ingredient_effect-select_c" name="ingredient_effect"> 
                <option value="">Effect optional</option>
                <% effects.forEach(effect => { %>
                    <option value="<%= effect._key %>"><%= effect.effect %></option>
                <% }) %>
            </select>
            <p>Effect not here? Create it! 2 new effects are allowed.</p>
            <button id="create-effect" style="display: inline">Create</button>
            <div class="effects__container-new" style="border: 1px solid black">

            </div>
            <button id="remove-ingredient" style="display: inline">Remove ingredient</button>
        </div>
    </template>

    <template id="template-effect">
        <div class="new-effect">
            <input type="text" id="effect_key-input" name="effect_key" placeholder="Effect Name" required>
            <input type="text" id="effect_description-input" name="effect_description" placeholder="Short Description" required>
            <select id="effect_type-select" name="effect_type" required>
                <option value=""></option>
                <option value="prevents">Prevents</option>
                <option value="ensures">Ensures</option>
            </select>
            <button id="remove-effect">Remove effect</button>
        </div>
    </template>

    <script src="/js/dynamicForm.js"></script>
    <script src="/js/adminControl.js"></script>
</body>
</html>